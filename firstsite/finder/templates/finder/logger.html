<!DOCTYPE html>
<html lang="en">
<head>
  <title>ENOMOTO Main Page</title>
  <meta charset="utf-8">

  <meta name="description" content="The Enomoto Main Page">
  
  <meta name="author" content="Mateus">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background-color: #ffffff;
    }
    table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }

    td, th {
      border: 0px;
      text-align: center;
      padding: 8px;
    }

    tr:nth-child(even) {
      background-color: #f2f1ed;
    }

    h1, h3, h5 {
      text-align: center;
    }

    #map {
      height: 100%;
    }
  </style>
</head>

<body>
  <h1>ENOMOTO</h1>

  <div id="map" style="width:800px; height:600px; margin:0 auto;"></div>

  <script type="text/javascript">
  setInterval(queryServer, 2000);

var map;
var marked = [{lat: 1, lng: 2}];

function initMap()
{
    map = new google.maps.Map(document.getElementById('map'), {
        center: new google.maps.LatLng(10.968840, -74.900124),
        zoom: 19,
    });
    // var marker = new google.maps.Marker({
    //     position: pos,
    //     map: map,
    //     title: 'Holi',
    // });
}

function queryServer()
{
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            comprehendInput(xhttp.responseText);
        }
    };
    xhttp.open("GET", "/finder/req", true);
    xhttp.send();
}

function comprehendInput(input)
{
    prett = JSON.parse(input);
    latitude  = prett.lat;
    longitude = prett.lon;
    time = prett.time;

    var check = 1;
    for(var i = 0; i < marked.length; ++i) {
        if(marked[i].lat == latitude && marked[i].lon == longitude)
            check = 0;
    }
    if(check == 1) {
        marked.push(prett);
        drawPoint(latitude, longitude, time);
    }
}

function drawPoint(latitude, longitude, time)
{
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(latitude, longitude),
        map: map,
        title: time,
    });
    map.setCenter(new google.maps.LatLng(latitude, longitude));
}
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCREYEOrU09R-W-A0ByBlymc-pZWFuwLec&callback=initMap" async defer></script>

  <h3>Registro de coordenadas geográficas</h3>
  <h5>Hardware de campo: Módem <em><span style="color:red;">Syrus 09781700</span></em></h5>

  <table>
    <tr>
      <th>Latitud</th>
      <th>Longitud</th>
      <th>Fecha</th>
      <th>IP</th>
      <th>Puerto</th>
    </tr>
    <!-- INI -->
    <!-- FIN -->
  </table>
</body>
</html>
